pipeline {
    agent any
    environment {
    BUILD_FILE_NAME = 'laptop.txt'
    }

    stages {
        stage('Build Laptop') {
            steps {
                // Clean the workspace before starting
                cleanWs()
                // checking env variable extraction, in double quote it will  extract
                echo "${BUILD_FILE_NAME}"
                // Run shell commands to simulate build
                sh '''
                echo "Building a laptop..."
                mkdir -p build
                echo "start" > build/${BUILD_FILE_NAME}
                echo "end" >> build/${BUILD_FILE_NAME}
                cat build/${BUILD_FILE_NAME}
                '''
            }
        }

        stage('TEST Laptop') {
            steps {
                // Test if the build artifact exists
                sh '''
                test -f build/${BUILD_FILE_NAME}
                echo "File exists!"
                grep "end" build/${BUILD_FILE_NAME}
                '''
            }
        }
    }

    post {
        success {
            // Archive build artifacts for download/inspection
            archiveArtifacts artifacts: 'build/**'
        }
    }
}

